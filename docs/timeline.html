<!DOCTYPE html>
<html>
<body>

<h1> title </h1>

<strong>Canvas</strong><br>

<div style='overflow:auto'>
<canvas id="myCanvas" width="2000" height="2000" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>
</div>

<script>

'use strict';

var canvas = document.getElementById('myCanvas');

var canvasHeight = canvas.height;
var canvasWidth = canvas.width;
console.log("Canvas: " + canvasHeight + "x" + canvasHeight); 

var ctx = canvas.getContext('2d');

canvas.addEventListener('click', function(event) {
    var elemLeft = canvas.offsetLeft + canvas.clientLeft;
    var elemTop = canvas.offsetTop + canvas.clientTop;
    var x = event.pageX - elemLeft;
    var y = event.pageY - elemTop;
	ctx.fillText("a",x,y);
	});

var startYear = 1800;
var endYear = 1900;
var timelineXMargin = 5;
var timelineYMargin = 5;
var tickLength = 10;

function yearToYPixel(year, numYears) {
  return timelineYMargin + (year * (canvasHeight-(2*timelineYMargin)) / numYears);
}

ctx.beginPath();
ctx.lineWidth = "3";
ctx.strokeStyle = "red";
ctx.moveTo(timelineXMargin, timelineYMargin);
ctx.lineTo(timelineXMargin, canvasHeight - timelineYMargin);
ctx.stroke();

ctx.beginPath();
ctx.linewidth = "3";
ctx.strokeStyle = "red";
var i;
for (i = 0; i <= (endYear - startYear); i++) {
  ctx.moveTo(timelineXMargin, yearToYPixel(i, endYear - startYear));
  ctx.lineTo(timelineXMargin + tickLength, yearToYPixel(i, endYear - startYear));
  ctx.fillText(startYear+i, timelineXMargin + tickLength + 2 ,yearToYPixel(i, endYear - startYear) + (ctx.measureText('M').width/2));
}
ctx.stroke();


var url = "";
if (window.location.href.startsWith("file:"))
{
  console.log("Local HTML");
  url = "https://petesndrs.github.io/timeline/timeline.json";
}
else
{
  console.log("Server HTML");
  url = "./timeline.json"
}


function fetchData() {
  return window.fetch(url).then(function(response) {
  console.log(response.status)
  return response.json();
}).then(function(data) {
  console.log(data);
  console.log("Fetch Done");
  return data;
}).catch(function(err) {
  console.log("Caught: " + err);
});
}

function doData(data) {
  var i;
  for (i in data.people) {
    console.log("> " + data.people[i].name);
  }
  console.log("Data Done");
}

var d = fetchData();
d.then(function(data){doData(data)});


</script>

</body>
</html>